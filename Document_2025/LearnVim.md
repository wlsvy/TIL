# Learn Vim

**Modes in Vim**

![](img/2024-05-29-21-54-51.png)

![](img/2024-05-29-21-55-46.png)

**Word(W)**

- w (word) : jump to the beginning of the next word
- b (back) : jump to the beginning of a word backwards
- e (end) : jump to the end of a word
- ge : jump to the end of a word backwards

**Insert 모드에서 사용할 수 있는 주요 동작**

1. **문자 삭제**
   - **백스페이스**: `Backspace` 키를 사용하여 커서 앞의 문자를 삭제합니다.
   - **Ctrl + w**: 커서 앞의 단어를 삭제합니다.
   - **Ctrl + u**: 커서 앞의 전체 라인을 삭제합니다.

2. **텍스트 입력과 관련된 기능**
   - **Esc**: Insert 모드를 종료하고 Normal 모드로 돌아갑니다.
   - **Ctrl + o**: Insert 모드를 유지하면서 Normal 모드의 단일 명령을 실행할 수 있게 해줍니다. 예를 들어, `Ctrl + o`를 누른 후 `w`를 입력하면 다음 단어로 이동합니다. 명령이 끝나면 Insert 모드로 자동 복귀합니다.

3. **자동 완성**
   - **Ctrl + n**: 단어 자동 완성 기능을 사용하여 다음 후보를 제시합니다.
   - **Ctrl + p**: 단어 자동 완성 기능을 사용하여 이전 후보를 제시합니다.

4. **현재 라인 복사**
   - **Ctrl + y**: 현재 라인의 한 줄 위에 있는 텍스트를 현재 커서 위치에 복사합니다.

5. **삽입된 텍스트 취소**
   - **Ctrl + u**: 커서 위치에서 현재 라인의 앞쪽 텍스트를 모두 삭제합니다.

6. **계산기**
  - **Ctrl-r 누른 뒤 =** : Insert 모드에서 계산기 사용

**현재 라인에서 키워드 교체**

현재 라인에서 특정 키워드를 다른 키워드로 교체하려면 다음 명령을 사용할 수 있습니다.

    :s/old_keyword/new_keyword/g

- `:s`: substitute 명령어.
- `old_keyword`: 변경할 키워드.
- `new_keyword`: 새로 바꿀 키워드.
- `g`: 해당 라인에서 일치하는 모든 키워드를 변경 (없으면 첫 번째 키워드만 변경).

**특정 범위에서 키워드 교체**

일정 범위의 라인에서 키워드를 교체하려면 다음과 같이 할 수 있습니다.

    :10,20s/old_keyword/new_keyword/g

- `10,20`: 10번 라인부터 20번 라인까지.

**파일 전체에서 키워드 교체**

파일 전체에서 키워드를 일괄 교체하려면 다음 명령어를 사용할 수 있습니다.

    :%s/old_keyword/new_keyword/g

- `%`: 파일 전체.

**특정 문자열을 포함한 라인 제거**

- `:g/특정문자열/d`
- `:g/^$/d`: 공백 라인만 찾아서 제거
- `:1,n g/특정문자열/d` : 특정 라인 범위에서 찾기

**임시버퍼 열기**

- `:enew`

**파일 열면서 명령 실행**

파일을 열면서 set number 명령 실행

`vim +':set number' 파일이름`\
or
`vim +set\ number path/to/file`

**라인 번호로 이동하기**

- :숫자를 입력한 후 Enter를 누르면 해당 라인으로 이동합니다.
- 예: `:25`를 입력하면 25번째 라인으로 이동합니다.
- 숫자를 입력한 후 G를 사용
- 예: `25G`를 입력하면 25번째 라인으로 이동합니다.

**클립보드에 파일 복사**

- `"+y` : 클립보드에 복사
- `"+p` : 클립보드에서 붙여넣기
- `"+yy` : 클립보드에 라인 전체 복사
- `ggvG"+y` : 전체파일 클립보드에 복사

**정렬**

- `==`: 라인 정렬

**터미널 관련**

- 터미널 열기: `:term`
- 터미널 모드 -> Normal 모드 : `<C-\><C-n>`

- 터미널 shell 설정 (ex: powershell)
  - vim script : `set shell=powershell`
  - lua : `vim.o.shell = 'powershell'`

- 터미널 명령 실행 후 stdout 을 가져오기
  - ex: `reader ! git --version` : git 버전 정보를 현재 버퍼에 입력한다.

혹은 shell 경로 지정 가능

```lua
vim.o.shell = 'C:/Program Files/PowerShell/7/pwsh.exe'
-- Lua에서는 경로 구분자로 슬래시(/)를 사용하는 것이 일반적입니다.
```

**Macro**

[Practical Vim 팁 요약 시리즈 - Macros !--- @n0lb00's Blog--](https://nolboo.kim/blog/2017/02/10/practical-vim/)

- `qa`: 매크로 기록 시작, 레지스터 a 에 저장된다. (참고: `:reg a`)
  - `qA` : `qa` 명령으로 매크로 기록 반복 시, 기존 레지스터에 덮어쓰지만 `qA` 의 경우 기존 애'
- `q` : 매크로 기록 종료
- `@{register}` : 특정 레지스터의 내용을 실행(`:h @`), 예를 들어 `@a` 으로 a 레지스터의 기록된 매크로 실행 가능
  - 반복 실행은 `10@a` 같은 명령어로 수행 가능

**File Encoding**

- `set fileencoding?` : 현재 파일 인코딩 확인
- `set fileencoding=<encoding>` : 현재 파일의 인코딩을 설정합니다. (저장 시 적용)
  * `set fileencoding=utf-8`
  * `set fileencoding=euc-kr`

- `e ++encoding=<encoding> <filepath>` : 파일 경로를 특정 인코딩으로 열기
  * `e ++encoding=euc-kr <filepath>` : utf8 이 아닌 한글 텍스트 파일은 이걸로 열어볼 수 있다.
  * `e ++encoding=utf-8 <filepath>`

- `:set fileencodings?` : Neovim이 파일을 열 때 시도하는 인코딩 목록을 확인합니다.
- `:set fileencodings=ucs-bom,utf-8,euc-kr,latin1` : 파일 열기 시도 순서를 설정합니다.
  * 일반적으로 `ucs-bom` (BOM이 있는 UTF), `utf-8`, `euc-kr` (또는 해당 지역 인코딩), `latin1` (기본값) 순으로 설정하여 파일을 정확하게 인식하도록 합니다.
  * `fileencodings`는 파일을 *읽을 때* 사용하는 인코딩 목록이며, `fileencoding`은 현재 버퍼의 인코딩이자 파일을 *저장할 때* 사용할 인코딩입니다.

- `:w ++enc=<encoding>` : 현재 파일을 다른 인코딩으로 저장합니다.
  * `:w ++enc=euc-kr`
  * `:w ++enc=utf-8`

## neovim

### Neovim 파일 경로 정보

#### 1. ShaDa 파일 경로
- **Windows**:  
  `C:\Users\<사용자 이름>\AppData\Local\nvim-data\shada\main.shada`
- **macOS**:  
  `~/.local/share/nvim/shada/main.shada`

#### 2. Neovim 설정 파일(`init.vim`) 경로
- **Windows**:  
  `C:\Users\<사용자 이름>\AppData\Local\nvim\init.vim`
- **macOS**:  
  `~/.config/nvim/init.vim`

#### 키맵핑 충돌 확인 방법 (key map collision check)

> 설정한 키맵핑이 다른 플러그인이나 기존 설정과 충돌하지 않는지 확인하려면 :verbose map 명령어를 사용하여 현재 사용 중인 모든 키맵핑을 확인할 수 있습니다.
- `:verbose map <A-j>`

- `:verbose map <A-k>`

## Commands

| 명령어         | 의미 (Stands for)             | 설명                            | 예시                                        |
| -------------- | ----------------------------- | ------------------------------- | --------------------------------            |
| `:g`           | Global                        | 패턴에 매칭되는 라인 처리       | `:g/error/d` → 'error' 삭제                 |
| `:v`           | InVerse (반대의 Global)       | 패턴에 매칭되지 않는 라인 처리  | `:v/error/d` → 'error' 제외 삭제, `:v/error | \warn/d` -> 여러 키워드 지정 가능 |
| `:s`           | Substitute                    | 문자열 대체                     | `:%s/foo/bar/g`                             |
| `:d`           | Delete                        | 라인 삭제                       | `:3,5d` → 3~5라인 삭제                      |
| `:t` / `:co`   | Transfer / Copy               | 라인 복사                       | `:3t$` → 3번 라인 복사                      |
| `:m`           | Move                          | 라인 이동                       | `:3m$` → 3번 라인 이동                      |
| `:!`           | Shell Command                 | 외부 명령 실행                  | `:!ls`                                      |
| `:r`           | Read                          | 파일/명령 결과 읽어오기         | `:r other.txt`                              |
| `:normal`      | Normal Mode                   | 노멀 모드 명령 실행             | `:g/error/normal dd`                        |
| `:join`        | Join                          | 라인 합치기                     | `:3,5join`                                  |
| `:>` / `:<`    | Indent Right / Indent Left    | 들여쓰기 증가/감소              | `:%>`                                       |

- grep 명령어 응용 예시
  - `g/keyword1/ | v/keyword2/ normal echo`

---

| **표현식**          | **설명**                            | **예시**                              |
| ------------------- | ----------------------------------- | ------------------------------------- |
| `expand('%')`       | 현재 파일 이름 (상대 경로)          | `test.txt`                            |
| `expand('%:p')`     | 현재 파일의 절대 경로               | `/home/user/project/test.txt`         |
| `expand('%:t')`     | 파일 이름만 (경로 제외)             | `test.txt`                            |
| `expand('%:h')`     | 현재 파일의 디렉토리 경로           | `/home/user/project`                  |
| `expand('<cfile>')` | 커서 아래에 있는 파일 경로          | `./myfile.txt`                        |

- `<cmd>put = expand('%:p')<CR>`: ex) 현재 파일 절대 경로를 열린 버퍼에 입력

---

| **명령어**                 | **설명**                                                | **예시**                                                      |
| -------------------------- | ------------------------------------------------------- | ----------------------------------------------------          |
| `line('w0')`               | 현재 커서의 위치를 라인 번호로 반환.                    | `line('.')` → 현재 커서가 위치한 라인 번호를 반환.            |
| `line('w0')`               | 윈도우의 첫 번째 행 번호를 반환.                        | `line('w0')` → 창의 첫 번째 행 번호 반환.                     |
| `line('$')`                | 파일의 마지막 라인 번호를 반환.                         | `line('$')` → 파일의 마지막 라인 번호 반환.                   |
| `line('w$')`               | 윈도우의 마지막 행 번호를 반환.                         | `line('w$')` → 창의 마지막 행 번호 반환.                      |
| `line('0')`                | 첫 번째 라인 번호를 반환.                               | `line('0')` → 1번 라인 번호 반환 (0은 첫 번째 줄을 의미).     |
| `line('v')`                | 비주얼 모드에서 선택된 영역의 시작 라인 번호를 반환.    | `line('v')` → 비주얼 영역의 시작 라인 번호 반환.              |
| `line('v$')`               | 비주얼 모드에서 선택된 영역의 끝 라인 번호를 반환.      | `line('v$')` → 비주얼 영역의 끝 라인 번호 반환.               |
| `line('w')`                | 현재 윈도우의 첫 번째 라인 번호를 반환.                 | `line('w')` → 현재 창에서 첫 번째 라인 번호 반환.             |
| `line('.')`                | 현재 커서 위치의 라인 번호를 반환.                      | `line('.')` → 현재 커서가 위치한 라인 번호 반환.              |
| `line('cursor')`           | 커서가 위치한 라인 번호 반환 (일반적으로 동일).         | `line('cursor')` → 커서가 있는 라인 번호 반환.                |
| `line('search')`           | 특정 텍스트 패턴을 찾은 라인 번호 반환.                 | `line('/pattern')` → 해당 패턴이 있는 첫 번째 라인 번호 반환. |
| `line('n')`                | `n`번 째 라인 번호를 반환.                              | `line(5)` → 5번째 라인 번호 반환.                             |

---

- **Neovim의 명령줄(Command-line)에서 사용할 수 있는 단축키**

| **단축키**  | **설명**                                                  |
| <C-b>       | 커서를 줄의 시작으로 이동.                                |
| <C-e>       | 커서를 줄의 끝으로 이동.                                  |
| <C-h>       | 백스페이스, 이전 문자 삭제.                               |
| <C-w>       | 이전 단어 삭제.                                           |
| <C-u>       | 커서 왼쪽의 모든 텍스트 삭제.                             |
| <C-a>       | 현재 명령줄의 내용을 커맨드 기록(history)에서 불러오기.   |
| <C-r>       | 레지스터 내용을 삽입. (예: <C-r>0는 0 레지스터 내용 삽입) |
| <C-d>       | 명령어 자동 완성 후보를 표시.                             | 
| <C-n>       | 다음 자동 완성 후보로 이동.                               |
| <C-p>       | 이전 자동 완성 후보로 이동.                               |
| <C-f>       | 명령줄 편집 모드를 창으로 열기 (cmdwin).                  |
| <Esc>       | 명령 입력 취소.                                           |
| <Tab>       | 명령어, 파일 이름 등 자동 완성.                           |
| <Shift-Tab> | 자동 완성에서 이전 후보로 이동.                           |

**Normal**

Neovim의 `normal` 명령어는 **Ex 모드(`:`)에서 일반 모드(Normal Mode)의 키 입력을 실행**하는 기능을 한다.

- `:normal {keys}`
- `{keys}` → 일반 모드에서 실행할 키 입력

| 명령어  | 설명                                       |
| normal  | 사용자 매핑이 적용된 상태에서 키 입력 실행 |
| normal! | 사용자 매핑을 무시하고 기본 동작을 실행    |

**Highlight**

| 명령어               | 기능 설명                                                                                          |
| -------------------- | ------------------------------------------------------------------------------------------------   |
| `:syntax enable`     | 문법 강조 기능을 활성화합니다. 기본적인 컬러 스킴을 유지하면서 문법 강조를 활성화합니다.           |
| `:syntax on`         | 문법 강조를 강제 활성화합니다. 컬러 스킴을 무시하고 문법 강조를 적용합니다.                        |
| `:syntax off`        | 문법 강조를 비활성화합니다.                                                                        |
| `:syntax list`       | 현재 적용된 모든 문법 강조 그룹을 출력합니다.                                                      |
| `:syntax clear`      | 모든 문법 강조 설정을 제거합니다.                                                                  |
| `:syntax keyword`    | 특정 키워드를 하이라이트하는 문법 그룹을 정의합니다. 예: `:syntax keyword MyGroup TODO FIXME NOTE` |
| `:syntax match`      | 정규식을 사용하여 특정 패턴을 하이라이트합니다. 예: `:syntax match MyGroup /ERROR/`                |
| `:highlight`         | 문법 그룹에 스타일을 적용합니다. 예: `:highlight MyGroup ctermfg=red guifg=red ctermbg=yellow`     |

- `:syntax enable`과 `:syntax on`은 문법 강조를 활성화하지만, `:syntax on`은 컬러 스킴을 무시하고 강제로 문법 강조를 적용합니다.
- `:syntax list`는 현재 활성화된 문법 그룹을 확인하는 데 유용하며, `:syntax clear`로 모든 강조 설정을 제거할 수 있습니다.
- `:syntax keyword`와 `:syntax match`는 특정 단어나 패턴을 하이라이트하는 데 사용되며, `:highlight` 명령어를 통해 하이라이트된 단어에 스타일을 적용할 수 있습니다.
- ctermfg, guifg : 글자 색상 변경 (터미널/GUI)
- ctermbg, guibg : 배경 색상 변경 (터미널/GUI)

**Search History**

| 기능                        | 단축키               |
| ------                      | ------               |
| 검색 히스토리 창 열기       | `q/`                 |
| 검색 히스토리 목록 확인     | `:history /`         |
| 검색 모드에서 히스토리 탐색 | `/` 입력 후 `Ctrl-f` |

**Neovim 이전 커서 위치 이동 방법**

| 카테고리        | 명령               | 설명                                                                                                                                                                                                                                                                             |
| :-------------  | :---------         | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------          |
| **점프 리스트** | **`Ctrl-o`**       | 이전 점프 위치로 이동합니다. (점프: 특정 명령으로 이동하거나 파일을 열었을 때 기록되는 위치)                                                                                                                                                                                     |
|                 | **`Ctrl-i`**       | `Ctrl-o`로 뒤로 이동한 후 다시 앞으로 이동합니다.                                                                                                                                                                                                                                |
|                 | **`:jumps`**       | 현재 점프 리스트를 보여줍니다.                                                                                                                                                                                                                                                   |
| **편집 위치**   | **`g;`**           | 마지막으로 \*\*변경(편집)\*\*한 위치로 이동합니다.                                                                                                                                                                                                                               |
|                 | **`g,`**           | `g;`로 뒤로 이동한 후 다시 앞으로 이동합니다.                                                                                                                                                                                                                                    |
|                 | **`:changes`**     | 변경 리스트를 보여줍니다.                                                                                                                                                                                                                                                        |
| **마크(Marks)** | **`m{소문자}`**    | 현재 커서 위치를 `{소문자}`로 마크합니다. (예: `ma`) 파일 내에서만 유효합니다.                                                                                                                                                                                                   |
|                 | **`m{대문자}`**    | 현재 커서 위치를 `{대문자}`로 마크합니다. (예: `mA`) 파일을 닫고 다시 열어도 유지되는 **글로벌 마크**입니다.                                                                                                                                                                     |
|                 | **`` ` {마크} ``** | 해당 마크의 **정확한 위치** (줄 번호 및 열 번호)로 이동합니다. (예: `` `a` ``)                                                                                                                                                                                                   |
|                 | **`' {마크}`**     | 해당 마크의 **줄의 첫 번째 비어있지 않은 문자열**로 이동합니다. (예: `  'a ` `)`                                                                                                                                                                                                 |
|                 | **`:marks`**       | 설정된 모든 마크를 보여줍니다.                                                                                                                                                                                                                                                   |
| **파일 열 때**  | 설정 필요          | `.vimrc` 또는 `init.lua` 파일에 설정을 추가하여, 파일을 다시 열었을 때 마지막으로 편집했던 위치로 자동으로 이동하게 할 수 있습니다. \<br\> (`.vimrc` 예시 참조: `augroup remember_cursor ...`) \<br\> (`init.lua` 예시 참조: `vim.api.nvim_create_autocmd("BufReadPost", ...)`). |

**Do 계열 명령어**

| 명령어       | 대상 범위 (Scope)               | 사용 예시             | 설명                                                                        |
| :---         | :---                            | :---                  | :---                                                                        |
| **`:windo`** | 현재 탭의 **모든 창** (Splits)  | `:windo e!`           | 현재 탭의 모든 분할 창에서 파일을 다시 로드합니다. |
| **`:tabdo`** | **모든 탭** (Tabs)              | `:tabdo w`            | 열려있는 모든 탭을 순회하며 저장합니다.                                     |
| **`:bufdo`** | (메모리에 로드된) **모든 버퍼** | `:bufdo %s/foo/bar/g` | 열려있는 모든 버퍼의 전체 내용에서 'foo'를 'bar'로 치환합니다.              |
| **`:argdo`** | `:args` 목록의 **모든 파일**    | `:argdo wq`           | Vim 시작 시 `vim *.txt`처럼 열었던 모든 파일을 저장하고 닫습니다.           |
| **`:cdo`**   | **Quickfix** 리스트의 모든 항목 | `:cdo s/error/fix/`   | Quickfix 창에 나열된 모든 위치에서 'error'를 'fix'로 바꿉니다.              |
| **`:ldo`**   | **Location** 리스트의 모든 항목 | `:ldo s/old/new/`     | Location 창(창 전용 Quickfix)의 모든 위치를 수정합니다.                     |

* 이 명령어들은 중첩해서 사용할 수 있습니다.
  * ex) **모든 탭(`:tabdo`)**의 **모든 창(`:windo`)**에서 `:e!` 실행:
    ```vim
    :tabdo windo e!
    ```

**특수문자digraphs**

`Ctrl+K`를 누른 뒤, 표의 **'입력 키'**에 해당하는 두 글자를 차례로 입력하면 해당 **'문자'**가 나옵니다.

- 자주 쓰이는 기호

| 문자  | 입력 키            | 설명                        |
| :---: | :---:              | :---                        |
| **°** | `DG`               | 도 (Degree)                 |
| **·** | `.` (마침표 두 번) | 가운데 점 (middot)          |
| **…** | `..`               | 말줄임표 (ellipsis)         |
| **©** | `Co`               | 저작권 (Copyright)          |
| **®** | `Rg`               | 등록 상표 (Registered)      |
| **™** | `TM`               | 상표 (Trademark)            |
| **§** | `SE`               | 섹션 (Section)              |
| **¶** | `PI`               | 문단 (Pilcrow)              |
| **†** | `dg`               | 단검표 (Dagger)             |
| **‡** | `dd`               | 이중 단검표 (Double dagger) |
| **•** | `bu`               | 글머리 기호 (Bullet)        |
| **✓** | `OK`               | 체크 표시                   |

- 수학 및 과학 (위 첨자/아래 첨자)

| 문자  | 입력 키 | 설명                    |
| :---: | :---:   | :---                    |
| **¹** | `s1`    | 위 첨자 1 (Superscript) |
| **²** | `s2`    | 위 첨자 2               |
| **³** | `s3`    | 위 첨자 3               |
| **⁰** | `s0`    | 위 첨자 0               |
| **ⁿ** | `sn`    | 위 첨자 n               |
| **₁** | `S1`    | 아래 첨자 1 (Subscript) |
| **₂** | `S2`    | 아래 첨자 2             |
| **₃** | `S3`    | 아래 첨자 3             |
| **₀** | `S0`    | 아래 첨자 0             |

- 수학 연산자

| 문자  | 입력 키 | 설명                |
| :---: | :---:   | :---                |
| **±** | `+-`    | 더하기/빼기         |
| **×** | `*X`    | 곱하기 (Times)      |
| **÷** | `:-`    | 나누기 (Divide)     |
| **≠** | `/=`    | 같지 않음           |
| **≤** | `<=`    | 작거나 같음         |
| **≥** | `>=`    | 크거나 같음         |
| **≈** | `~=`    | 거의 같음 (Approx.) |
| **√** | `RT`    | 제곱근 (Root)       |
| **∞** | `oo`    | 무한대 (Infinity)   |
| **∑** | `SU`    | 합계 (Sum)          |
| **∫** | `IN`    | 적분 (Integral)     |

- 그리스 문자 (일부)

| 문자  | 입력 키 | 설명            |
| :---: | :---:   | :---            |
| **α** | `*a`    | 알파 (Alpha)    |
| **β** | `*b`    | 베타 (Beta)     |
| **γ** | `*g`    | 감마 (Gamma)    |
| **δ** | `*d`    | 델타 (Delta)    |
| **π** | `*p`    | 파이 (Pi)       |
| **Ω** | `*O`    | 오메가 (대문자) |
| **Δ** | `*D`    | 델타 (대문자)   |
| **Σ** | `*S`    | 시그마 (대문자) |

- 화폐 기호

| 문자  | 입력 키 | 설명           |
| :---: | :---:   | :---           |
| **€** | `Eu`    | 유로 (Euro)    |
| **£** | `Pd`    | 파운드 (Pound) |
| **¥** | `Ye`    | 엔 (Yen)       |
| **¢** | `Ct`    | 센트 (Cent)    |
| **₩** | `W=`    | 원 (Won)       |

- 화살표 및 기타 기호

| 문자  | 입력 키 | 설명               |
| :---: | :---:   | :---               |
| **→** | `->`    | 오른쪽 화살표      |
| **←** | `<-`    | 왼쪽 화살표        |
| **↑** | `ua`    | 위쪽 화살표        |
| **↓** | `da`    | 아래쪽 화살표      |
| **↔** | `<>`    | 양쪽 화살표        |
| **⇒** | `=>`    | 오른쪽 굵은 화살표 |
| **⇐** | `<=`    | 왼쪽 굵은 화살표   |
| **★** | `*?`    | 별 (채워진)        |
| **☆** | `'?`    | 별 (빈)            |
| **½** | `12`    | 1/2                |
| **¼** | `14`    | 1/4                |
| **¾** | `34`    | 3/4                |


현재 설정에서 사용 가능한 모든 Digraph 목록과 입력 키 목록 확인

```vim
:digraphs
--
:redir @a | digraphs | redir END -- 레지스터 'a' 에 복사
```

